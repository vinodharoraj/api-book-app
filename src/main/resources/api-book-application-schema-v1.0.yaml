openapi: 3.0.3
info:
  title: Book & Author API
  version: 1.0.0
  description: API generated from BookController and AuthorController
servers:
  - url: http://localhost:8080
tags:
  - name: BookController
    description: Book-related endpoints
  - name: AuthorController
    description: Author-related endpoints
paths:
  /getBook/{id}:
    get:
      tags:
        - BookController
      summary: Retrieve a book by id
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Book found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BookResponseDTO'
        '404':
          description: Book not found
  /getAllBooks:
    get:
      tags:
        - BookController
      summary: Retrieve all books
      responses:
        '200':
          description: List of books
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/BookResponseDTO'
  /filterBooks:
    get:
      tags:
        - BookController
      summary: Filter books by author and genre, grouped by genre
      parameters:
        - name: author
          in: query
          required: true
          schema:
            type: string
          description: Author name (partial or full)
        - name: genre
          in: query
          required: true
          schema:
            type: string
          description: Genre to filter by
      responses:
        '200':
          description: Map of genre to list of books
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: array
                  items:
                    $ref: '#/components/schemas/BookResponseDTO'
  /addBook:
    post:
      tags:
        - BookController
      summary: Add a new book
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Book'
      responses:
        '200':
          description: Author response after saving book
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorResponseDTO'
        '400':
          description: Bad request
  /authors/search:
    get:
      tags:
        - AuthorController
      summary: Search authors by name
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
          description: Substring to search in author names
      responses:
        '200':
          description: Matching authors
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AuthorResponseDTO'
        '404':
          description: No authors found
  /authors/update/{id}:
    put:
      tags:
        - AuthorController
      summary: Update an author
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Author'
      responses:
        '200':
          description: Updated author response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorResponseDTO'
        '400':
          description: Bad request
        '404':
          description: Author not found
components:
  schemas:
    Book:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 100
        title:
          type: string
          example: Pride and Prejudice
        isbn:
          type: string
          example: 978-0140434266
        genere:
          type: string
          example: Novel
        authorId:
          type: integer
          format: int64
          example: 5
      required:
        - title
        - authorId
    BookResponseDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 100
        title:
          type: string
          example: Pride and Prejudice
        genere:
          type: string
          example: Novel
        author:
          $ref: '#/components/schemas/AuthorResponseDTOShort'
      required:
        - id
        - title
        - genere
        - author
    Author:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 5
        firstName:
          type: string
          example: Jane
        lastName:
          type: string
          example: Austen
        email:
          type: string
          format: email
          example: jane.austen@test.com
        bio:
          type: string
          example: Author bio
        genere:
          type: string
          example: Classic
      required:
        - firstName
        - lastName
    AuthorResponseDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 5
        name:
          type: string
          example: Jane Austen
        firstName:
          type: string
          example: Jane
        lastName:
          type: string
          example: Austen
        bookCount:
          type: integer
          example: 3
    AuthorResponseDTOShort:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 5
        firstName:
          type: string
          example: Jane
        lastName:
          type: string
          example: Austen
        email:
          type: string
          format: email
          example: jane.austen@test.com
      required:
        - id
        - firstName
        - lastName